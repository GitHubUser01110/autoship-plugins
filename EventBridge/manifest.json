{
    "id": "EventBridge",
    "name": "事件桥接器插件 (WebSocket + 摄像头)",
    "version": "1.0.4",
    "description": "基于WebSocket的双向事件桥接器，支持设备控制和摄像头视频流传输",
    "author": "Ship Control Team",
    "entry": "plugin.py",
    "updated_at": "2025-10-08T00:00:00Z",
    "dependencies": [],
    "config_schema": [
        {
            "key": "listen_port",
            "type": "number",
            "default": 13000,
            "min": 10001,
            "max": 65535,
            "description": "WebSocket监听端口",
            "required": true
        },
        {
            "key": "devices",
            "type": "object",
            "default": {
                "usb2xxx_1": {
                    "description": "主控设备"
                }
            },
            "description": "设备配置表 {device_name: {description}}",
            "required": true
        }
    ],
    "interfaces": [
        {
            "name": "get_bridge_status",
            "description": "获取桥接器状态（包括摄像头流统计）",
            "input_schema": {},
            "output_schema": {
                "running": "boolean",
                "listen_port": "number",
                "connected_devices": "array",
                "client_count": "number",
                "camera_stream_count": "number",
                "statistics": "object"
            }
        },
        {
            "name": "get_device_connection",
            "description": "获取设备连接状态",
            "input_schema": {
                "device_name": "string"
            },
            "output_schema": {
                "success": "boolean",
                "connected": "boolean",
                "remote_address": "string"
            }
        },
        {
            "name": "broadcast_message",
            "description": "广播消息到所有客户端",
            "input_schema": {
                "message": "object"
            },
            "output_schema": {
                "success": "boolean",
                "message": "string"
            }
        },
        {
            "name": "get_camera_streams",
            "description": "获取所有摄像头流信息",
            "input_schema": {},
            "output_schema": {
                "success": "boolean",
                "stream_count": "number",
                "streams": "object"
            }
        },
        {
            "name": "stop_camera_stream",
            "description": "停止指定摄像头流",
            "input_schema": {
                "camera_id": "string",
                "device_name": "string"
            },
            "output_schema": {
                "success": "boolean",
                "message": "string"
            }
        }
    ],
    "events": {
        "publishes": [
            "device.command.result",
            "device.status.**",
            "sensor.**",
            "alert.**",
            "system.heartbeat",
            "bridge.started",
            "bridge.stopped",
            "bridge.error",
            "camera.frame.**",
            "camera.stream.started",
            "camera.stream.stopped",
            "camera.control.result"
        ],
        "subscribes": [
            "device.command.**"
        ]
    }
}